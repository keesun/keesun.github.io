---
layout: post
title: 태그 파일
date: 2008-02-18 11:00:12.000000000 -08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- JSP
tags:
- JSP 기초
- 태그 파일
meta:
  arkayne-cache-post: |2+







    <!-- BlogGlue Plugin Error -->
    <!-- This page cannot be linked by BlogGlue. -->
    <!-- You need a valid token. Get one at the URL below. -->
    <!-- http://www.blogglue.com/login/ -->

















  arkayne-time-post: '1323000476'
author:
  login: whiteship
  email: whiteship2000@gmail.com
  display_name: 기선
  first_name: 기선
  last_name: 백
---
<p>참조<br /><a href="http://today.java.net/pub/a/today/2003/11/14/tagfiles.html" target="_blank">Easy Custom Tags with Tag Files, Part 1</a><br /><a href="http://today.java.net/pub/a/today/2003/11/25/tagfiles.html" target="_blank">Easy Custom Tags with Tag Files, Part 2</a></p>
<p>JSP 2.0 이전의 커스텀 태그 사용법<br />1. 핸들러를 작성하고 컴파일 한다.<br />2. 태그 핸들러와 관련된 태그를 정의한다.</p>
<p>그러나 태그 파일은 미리 컴파일 할 필요 없다. 호출 되는 순간 컴파일 된다. <br />핸들러 또한 오직 JSP 문법만을 사용하여 만들 수 있다.<br />태그 라이브러리 서술자 역시 만들 필요 없다. 태그 파일이름을 태그 이름으로 사용하기 때문에.</p>
<p>태그 파일에서 묵시적으로 사용 가능한 객체들<br />- request &nbsp; &nbsp; javax.servlet.http.HttpServletRequest<br />- response &nbsp; &nbsp; javax.servlet.http.HttpServletResponse<br />- out &nbsp; &nbsp; javax.servlet.jsp.JspWriter<br />- session &nbsp; &nbsp; javax.servlet.http.HttpSession<br />- application &nbsp; &nbsp; javax.servlet.ServletContext<br />- config &nbsp; &nbsp; javax.servlet.ServletConfig<br />- jspContext &nbsp; &nbsp; javax.servlet.jsp.JspContext</p>
<p>태그 파일 지시자<br />- &lt;%@ 로 열고 %&gt; 로 닫는다.<br />- tag&nbsp; &nbsp; &nbsp; JSP 페이지의 page와 비슷한 지시자<br />- include &nbsp; &nbsp; 태그 파일에 다른 자원을 포함시킬 때 사용하는 지시자<br />- taglib &nbsp; &nbsp; 태그 파일에서 커스텀 태그 라이브러리를 사용하고자 할 때 사용<br />- attribute &nbsp; &nbsp; 태그 파일에 속성 선언할 때 사용<br />- variable &nbsp; &nbsp; 호출하는 JSP 페이지로 넘겨줄 변수를 정의할 때 사용</p>
<p>tag 지시자의 속성<br />- display-name&nbsp; &nbsp; &nbsp; XML 툴에 의해 보여질 간단한 이름. 기본값은 .tag를 짤라버린 태그 파일이름.<br />- body-content &nbsp; &nbsp; 이 태그의 몸체 컨텐츠에 대한 정보. The value can be empty, tagdependent, or scriptless (default).<br />- dynamic-attributes &nbsp; &nbsp; 동적인 속성의 지원 여부 알려줌. The value identifies a scoped attribute in which to place a Map containing the names and values of the dynamic attributes passed during this invocation.<br />- small-icon &nbsp; &nbsp; 보통 사용하지 않는다니까 패스.<br />- large-icon &nbsp; &nbsp; 보통 사용하지 않는다니까 패스.<br />- description &nbsp; &nbsp; 태그에 대한 설명.<br />- example &nbsp; &nbsp; 이 액션을 사용하는 방법에 설명.<br />- language &nbsp; &nbsp; 태그 파일에서 사용되는 스크립트 언어. The value for this attribute for the current version of JSP must be "java".<br />- import &nbsp; &nbsp; page의 import와 같다.<br />- pageEncoding &nbsp; &nbsp; page의 속성과 같다.<br />- isELIgnored &nbsp; &nbsp; 기본값은 false. page의 속성과 같다.<br />- 사용예<br />&lt;%@ tag body-content="empty"<br />import="java.util.Enumeration" %&gt;<br />&lt;%@ tag import="java.sql.*" %&gt;<br />- import 빼고는 한 번만 나올 것이다.(모든 속성이 optional이다.)</p>
<p>include 지시자<br />- 여러 태그 파일에서 공통으로 사용되는 코드가 있을 때 사용한다.<br />- 사용예<br />&lt;%@ include file="included.tagf" %&gt;</p>
<p>taglib 지시자<br />- &lt;%@ taglib uri="tagLibraryURI" prefix="tagPrefix" %&gt; 이런 문법 사용한다.<br />- 사용예<br />&lt;%@ taglib prefix="simple" tagdir="/WEB-INF/tags" %&gt;<br />The server's date: &lt;simple:firstTag/&gt;</p>
<p>attribute 지시자 속성<br />- name&nbsp; &nbsp; &nbsp; 이 태그 파일이 받아들일 때 사용할 속성 이름. 이 이름은 해당 태그 파일에서 유일 해야 한다.<br />- required &nbsp; &nbsp; 필수 속성인지 아닌지. false가 기본값.<br />- fragment &nbsp; &nbsp; 태그 핸들러에 의해 계산되는 fragment인지 아닌지 컨테이너가 그냥 처리할 녀석인지 알려준다. 기본값은 false. 속성의 값을 태그 핸들러가 먼저 처리해야 되면 true로 설정하라.<br />- rtexprvalue &nbsp; &nbsp; 속성의 값이 scriptlet expression에 의해 동적으로 계산되는 값인지 알려준다. true가 기본값.<br />- type &nbsp; &nbsp; 속성의 타입. java.lang.String이 기본값.<br />- description &nbsp; &nbsp; 속성에 대한 설명.</p>
<p>variable 지시자 속성<br />- atttibute 지시자와 반대로, JSP로 태그 파일안에 있는 어떤 값을 넘겨 줄 수 있고, 여러개를 선언할 수 있으니까 여러 개의 값을 이 태그를 사용한 JSP로 넘길 수 있다.<br />- name-given&nbsp; &nbsp; &nbsp; 호출한 JSP에 있는 스크립트 언어나 EL 표현식에서 사용할 수 있는 변수 이름. name-from-attribute와 이 속성 둘 중 하나만 존재해야 한다. 태그 파일 내에서 유일해야 한다.<br />- name-from-attribute &nbsp; &nbsp; name-given과 동일한데, 다만 이 속성의 값이 attribute의 이름이다.<br />- alias &nbsp; &nbsp; 이 변수의 값을 가지고 있을 로컬 attriute<br />- variable-class &nbsp; &nbsp; 이 변수의 타입. java.lang.String이 기본값.<br />- declare &nbsp; &nbsp; 이 것을 호출하는 페이지나 태그 파일에서 변수가 선언되어 있는지 알려준다. true가 기본값.<br />- scope &nbsp; &nbsp; The scope of the scripting variable defined. The possible values are AT_BEGIN, AT_END, and NESTED (default).<br />- description &nbsp; &nbsp; 변수에 대한 설명.<br />- 예제
<div style="border: 1px solid rgb(204, 204, 204); padding: 10px; background-color: rgb(247, 247, 247);">&lt;%@ tag import="java.util.Date" <br />import="java.text.DateFormat"%&gt;<br /><span style="font-weight: bold;">&lt;%@ variable name-given="longDate" %&gt;</span><br style="font-weight: bold;" /><span style="font-weight: bold;">&lt;%@ variable name-given="shortDate" %&gt;</span><br />&lt;%<br />&nbsp; Date now = <br />new Date(System.currentTimeMillis());<br />&nbsp; DateFormat longFormat = <br />DateFormat.getDateInstance(DateFormat.LONG);<br />&nbsp; DateFormat shortFormat = <br />DateFormat.getDateInstance(DateFormat.SHORT);<br /><span style="font-weight: bold;">&nbsp; jspContext.setAttribute(</span><br style="font-weight: bold;" /><span style="font-weight: bold;">"longDate", longFormat.format(now));</span><br style="font-weight: bold;" /><span style="font-weight: bold;">&nbsp; jspContext.setAttribute(</span><br style="font-weight: bold;" /><span style="font-weight: bold;">"shortDate", shortFormat.format(now));</span><br />%&gt;<br />&lt;jsp:doBody/&gt;</div>
<p>
<div style="border: 1px solid rgb(204, 204, 204); padding: 10px; background-color: rgb(247, 247, 247);">&lt;%@ taglib prefix="tags" <br />tagdir="/WEB-INF/tags" %&gt;<br />Today's date:<br />&lt;br/&gt;<br />&lt;tags:varDemo&gt;<br /><span style="font-weight: bold;">In long format: ${longDate}</span><br />&lt;br/&gt;<br /><span style="font-weight: bold;">In short format: ${shortDate}</span><br />&lt;/tags:varDemo&gt;</div>
<p>jsp:doBody<br />- 오직 태그 파일 안에서만 사용할 수 있다.<br />- 태그의 몸체를 실행할 때 사용한다.<br />- 몸체를 호출한 결과를 특정 변수에 담고 싶을 때는 var(값을 String으로 받는다.)나 varReader(값을 Reader로 받는다.) 속성을 사용한다.<br />- 예제<br />&lt;jsp:doBody var="referer" <br />scope="session"/&gt;<br />저렇게 정의해둔 태그로 둘러 쌓인 부분을 실행한 결과를 String 타입으로 refer라는 변수에 session 스콥으로 가지고 있는다.</p>
<p>jsp:invoke<br />- fragment attribute를 호출할 때 사용한다.<br />- attribute를 fragment로 설정했다면, 태그 파일 안에서 원하는 만큼 여러번 호출할 수 있다.<br />- 이것도 jsp:doBody과 같은 역할을 하는 속성을 가질 수 있고, fragment는 필수 속성이다.<br />- 예제
<div style="border: 1px solid rgb(204, 204, 204); padding: 10px; background-color: rgb(247, 247, 247);">&lt;%@ attribute name="productDetails" <br />fragment="true" %&gt;<br />&lt;%@ variable name-given="productName" %&gt;<br />&lt;%@ variable name-given="description" %&gt;<br />&lt;%@ variable name-given="price" %&gt;<br />&lt;%<br />&nbsp; jspContext.setAttribute(<br />"productName", "Pelesonic DVD Player");<br />&nbsp; jspContext.setAttribute(<br />"description", <br />&nbsp; &nbsp; "Dolby Digital output through <br />coaxial digital-audio jack," + <br />&nbsp; &nbsp; " 500 lines horizontal <br />resolution-image digest viewing");<br />&nbsp; jspContext.setAttribute("price", "65");<br />%&gt;<br />&lt;jsp:invoke fragment="productDetails"/&gt;</div>
<p>
<div style="border: 1px solid rgb(204, 204, 204); padding: 10px; background-color: rgb(247, 247, 247);">&lt;%@ taglib prefix="easy" <br />tagdir="/WEB-INF/tags" %&gt;<br />&lt;html&gt;<br />&lt;head&gt;<br />&lt;title&gt;Product Details&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&lt;easy:invokeDemo&gt;<br />&nbsp; &lt;jsp:attribute name="productDetails"&gt;<br />&nbsp; &nbsp; &lt;table width="220" border="1"&gt;<br />&nbsp; &nbsp; &lt;tr&gt;<br />&nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;Product Name&lt;/b&gt;&lt;/td&gt;<br />&nbsp; &nbsp; &nbsp; &lt;td&gt;${productName}&lt;/td&gt;<br />&nbsp; &nbsp; &lt;/tr&gt;<br />&nbsp; &nbsp; &lt;tr&gt;<br />&nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;Description&lt;/b&gt;&lt;/td&gt;<br />&nbsp; &nbsp;&nbsp; &lt;td&gt;${description}&lt;/td&gt;<br />&nbsp; &nbsp; &lt;/tr&gt;<br />&nbsp; &nbsp; &lt;tr&gt;<br />&nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;Price&lt;/b&gt;&lt;/td&gt;<br />&nbsp; &nbsp; &nbsp; &lt;td&gt;${price}&lt;/td&gt;<br />&nbsp; &nbsp; &lt;/tr&gt;<br />&nbsp; &nbsp; &lt;/table&gt;<br />&nbsp; &lt;/jsp:attribute&gt;<br />&lt;/easy:invokeDemo&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;</div>
<p>태그 파일 패키징하기<br />- 태그 라이브러리 서술자. tld 파일을 만들어야 한다.
<div style="border: 1px solid rgb(204, 204, 204); padding: 10px; background-color: rgb(247, 247, 247);">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</p>
<p>&lt;taglib xmlns="http://java.sun.com/xml/ns/j2ee"<br />&nbsp; xmlns:xsi=<br />"http://www.w3.org/2001/XMLSchema-instance"<br />&nbsp; xsi:schemaLocation=<br />"http://java.sun.com/xml/ns/j2ee web-jsptaglibrary_2_0.xsd"<br />&nbsp; version="2.0"&gt;<br />&nbsp; <br />&nbsp; &lt;description&gt;JSP 2.0 tag files&lt;/description&gt;<br />&nbsp; &lt;tlib-version&gt;1.0&lt;/tlib-version&gt;<br />&nbsp; &lt;short-name&gt;My Tag Files&lt;/short-name&gt;<br />&nbsp; &lt;uri&gt;http://www.brainysoftware.com/tagfiles&lt;/uri&gt;<br />&nbsp; &lt;tag-file&gt;<br />&nbsp; &nbsp; &lt;name&gt;encode&lt;/name&gt;<br />&nbsp; &nbsp; &lt;path&gt;/META-INF/tags/encode.tag&lt;/path&gt;<br />&nbsp; &lt;/tag-file&gt;<br />&lt;/taglib&gt;</div>
<p>- 루트 폴더 밑에 META-INF 폴더를 만들고 그 안에 서술자 파일을 넣는다.<br />- 태그 파일들은 META-INF 폴더 밑에 tags폴더를 만들고 그 안에 넣는다.<br />- JAR파일로 묶는다. ex) jar cvf mytagfiles.jar *<br />- 사용한다.
<div style="border: 1px solid rgb(204, 204, 204); padding: 10px; background-color: rgb(247, 247, 247);">&lt;%@ taglib prefix="easy" <br />uri="http://www.brainysoftware.com/tagfiles" %&gt;<br />&lt;easy:encode input="&lt;br/&gt; means changing line"/&gt;</div>
<p></p>
